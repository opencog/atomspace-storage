
INCLUDE_DIRECTORIES(
	${PYTHON_INCLUDE_DIRS}
	${CMAKE_CURRENT_SOURCE_DIR}
	${CMAKE_CURRENT_BINARY_DIR}
)

SET(CYTHON_FLAGS "-3" "-f" "-Wextra")

# storage.pxy means that module nname will be 'opencog.storage'
# and this will have an autogenerated PyInit_storage() in it.
# (based on the name of the pyx)
CYTHON_ADD_MODULE_PYX(storage
	"../../storage/storage_types.pyx"
	"../../storage/storage_types.h")

ADD_LIBRARY(storage_cython SHARED
	PersistCython.cc
	storage.cpp
)

ADD_DEPENDENCIES(storage_cython storage_types)

TARGET_LINK_LIBRARIES(storage_cython
	${NO_AS_NEEDED}
	atomspace
	${PYTHON_LIBRARIES}
)

SET_TARGET_PROPERTIES(storage_cython PROPERTIES
	PREFIX ""
	OUTPUT_NAME storage)

### install the modules ###
INSTALL(TARGETS
	storage_cython
	DESTINATION "${PYTHON_DEST}")
